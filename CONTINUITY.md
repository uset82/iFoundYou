# Continuity Ledger

- Goal (incl. success criteria): Build a Loopt-like test web app (Netlify deploy) with OpenAI App SDK integration; add ability to send friend requests from phone/email contacts; extend the product plan for emergency/off-grid messaging and calling on iOS/Android; clarify whether offline messaging can work in a web-only app for ChatGPT app store.
- Constraints/Assumptions: ASCII preferred; repo includes web app in `web/`; no tests yet; Windows path cannot include `http://` so `http://CONTINUITY.md` refers to `CONTINUITY.md`; user expects minimal questions and prefers the agent to run steps.
- Key decisions: Proceed with default stack (Vite React, MapLibre, Supabase PostGIS, Netlify Functions); project name is "IfoundYou"; create Supabase schema file before wiring RLS; best path for offline mesh is a native companion app plus the web app for the ChatGPT store; choose React Native for the companion app to reuse React code and integrate native Bluetooth/Wi-Fi modules.
- State: Google OAuth added; email sign-up validates password length; Grok/X-style UI live with logo; adding community emergency alerts for disasters (water/food/medical/lost); user hit SQL error by pasting JS into SQL editor; user attempting Google provider setup in Supabase; Google OAuth client created (ID + secret) and needs to be added to Supabase; Google console error due to callback URL placed in Authorized JavaScript origins; Supabase SQL editor cannot alter `public.spatial_ref_sys` (ownership); Netlify site loads blank and likely missing Supabase envs; OAuth redirect is going to localhost:3000 and needs Supabase URL Configuration updated; contact-based friend request flow added (schema + RPC + UI); reported UI issue: nav buttons (Friends/Alerts/Discover/Settings) not clickable after sign in; attempted fix by isolating map panel stacking; reported iPhone layout messy, added tighter mobile styles and contact card fixes; Friends view simplified to a single invite/share card with Apple/Google/Facebook/Instagram suggestions and pushed to GitHub; new request: update emergency/off-grid messaging and calling plan based on research notes.
- Done: Read Loopt research files; delivered plan in `docs/plan.md`; scaffolded Vite app; converted to React; added MapLibre map and geolocation; updated map style/markers/controls; added Netlify config + health + location-update + nearby + discover + alerts + cleanup functions; added `.env.example`; added Supabase schema + RLS + triggers; added Supabase client + auth UI; wired location writes to Supabase with alerts call; added friend requests + pending lists; added friend markers + nearby list + notification prompts; added discoverable toggle + discovery list; added alerts inbox UI; added Google OAuth sign-in button and password length validation; updated `docs/supabase-setup.md`; added `supabase/.env.example`; added `docs/openai-tools.json` + `docs/openai-integration.md`; added `docs/deploy.md`; updated `AGENTS.md`; updated `netlify.toml` build command; set local `web/.env` and root `.env` with Supabase URL + anon key; made schema enum creation idempotent; fixed MapLibre null checks; `npm run build` succeeded; redesigned UI to Grok/X-inspired dark layout in `web/src/App.tsx` and `web/src/style.css`; added logo lockup in sidebar brand; added community alert schema, RLS, Netlify function, and UI; added README with setup + deploy steps; initialized git repo and pushed to GitHub; added safe Supabase client fallback for missing envs and pushed fix; added `profiles` contact email/phone fields + `match_contacts` RPC; added contact import/paste + settings UI and styles for contact-based friend requests; added map panel containment styles to avoid overlay issues; added mobile layout tightening for iPhone; moved contact-picker warning below button and added mobile layout tightening for buttons/text wrapping; simplified Friends view to a single invite/share card and added Apple/Google share options; added emergency-mode addendums to `messcomunication.md`, `iPhone Mesh Communication Research.md`, `Off-Grid Mesh Messaging_ Open-Source Projects & Technologies.md`, and `Offline Communication App Research.md`; created `docs/native-companion-plan.md` with the React Native offline mesh plan; scaffolded React Native app in `mobile/` (IfoundYouMobile) and removed the nested `.git`; added baseline mobile shell (tabs + screens), config stub, Supabase client stub, and `.env.example`; added `@supabase/supabase-js` to mobile dependencies.
- Now: Decide whether to commit and push the new `mobile/` app and baseline files; then wire BLE and Multipeer modules.
- Next: Enable Google provider in Supabase and validate auth flow; set Netlify env vars and deploy.
- Open questions (UNCONFIRMED if needed): Clarify what "upload into ChatGPT app" means (GPT, App SDK app, or share link); obtain Supabase service role key if you want scheduled cleanup on Netlify later; untracked `client_secret_*.json` and `image/` folders seen in repo - confirm whether to ignore or include (avoid pushing secrets).
- Working set (files/ids/commands): `AGENTS.md`, `CONTINUITY.md`, `README.md`, `docs/plan.md`, `docs/supabase-setup.md`, `docs/openai-tools.json`, `docs/openai-integration.md`, `docs/deploy.md`, `netlify.toml`, `.gitignore`, `netlify/functions/health.js`, `netlify/functions/location-update.js`, `netlify/functions/nearby.js`, `netlify/functions/discover.js`, `netlify/functions/alerts.js`, `netlify/functions/community-alerts.js`, `netlify/functions/cleanup.js`, `supabase/schema.sql`, `supabase/rls.sql`, `supabase/triggers.sql`, `web/src/App.tsx`, `web/src/style.css`, `messcomunication.md`, `iPhone Mesh Communication Research.md`, `Off-Grid Mesh Messaging_ Open-Source Projects & Technologies.md`, `Offline Communication App Research.md`.
